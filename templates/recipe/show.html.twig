{% extends 'base.html.twig' %}

{% block title %}Recipe{% endblock %}

{% block body %}

    <div style="margin-right: 400px; margin-left: 400px; border: solid 1px black; margin-top: 100px; height: auto; margin-bottom: 100px; ">
        <h2 style="text-align: center; padding-top: 15px;">{{ recipe.name }}</h2>
        <p style="text-align: center; padding-bottom: 10px;">par {{ recipe.user.name }}</p>
        <img id="product_img_detail" src="/upload/{{ recipe.picture }}"/>
        <div style="border-bottom: solid 1px black;">
            <p style="padding: 15px; text-align: center;"><img src="/img/time.png" style="height: 25px; width: 25px; margin-bottom: 5px;"> {{ recipe.preparationTime }} minutes | <img src="/img/nbperson.png" style="height: 25px; width: 25px; margin-bottom: 5px;"> {{ recipe.numberOfPerson }} personne(s) | <img src="/img/level.png" style="height: 25px; width: 25px; margin-bottom: 5px;"> {{ recipe.difficulty }}</p>
        </div>
        <div style="border-bottom: solid 1px black;">
            <h4 style="text-align: center; padding: 5px; border-bottom: dashed 1px black;">Ingrédients :</h4>
            <p style="text-align: center;">{{ recipe.ingredients }}</p>
        </div>
        <div style="border-bottom: solid 1px black;">
            <h4 style="text-align: center; padding: 5px; border-bottom: dashed 1px black;">Ustensiles :</h4>
            <p style="text-align: center;">{{ recipe.utensils }}</p>
        </div>
        <div>
            <h4 style="text-align: center; padding: 5px; border-bottom: dashed 1px black;">Préparation :</h4>
            <p style="text-align: center; padding: 10px; text-align: left;">{{ recipe.content }}</p>
        </div>
    </div>

    {% if is_granted('ROLE_USER') %}
        <div style="margin-right: 400px; margin-left: 400px; border: solid 1px black; margin-top: 100px; height: auto; margin-bottom: 100px; ">
            <div>
                <h4 style="text-align: center; padding: 5px; border-bottom: dashed 1px black;">Commentaires :</h4>
            </div>
            <div style="text-align: center;">
                {{ form_start(form, {'action': path('app_commentary_new', {id: recipe.id}), 'method': 'POST'}) }}
                {{ form_widget(form.content) }}
                <button class="btn" style="color: white; background-color: blue; width: 700px; margin-left: 8px; margin-right: 5px; margin-bottom: 10px;">{{ button_label|default('Publier') }}</button>
                {{ form_end(form) }}
            </div>
            <div style="text-align: left; border-top: solid 1px black;">
                {% for commentary in commentary %}
                    <div style="padding: 15px; border-bottom: dotted 1px black;">
                        <p style="font-weight: bold;">{{ commentary.user.name }} :</p>
                        <p style="font-style: italic;">"{{ commentary.content }}"</p>
                        {% if app.user.id == commentary.user.id %}
                            {{ include('commentary/_delete_form.html.twig') }}
                            <a class="btn" style="background-color: orange; color: white; width: 98px; margin-top: 5px;" href="{{ path('app_commentary_edit', {'id': commentary.id}) }}">Modifier</a>

                        {% endif %}
                    </div>

                {% endfor %}
            </div>
        </div>
    {% else %}
        <p style="text-align: center;">Pour accéder aux commentaires, veuillez-vous identifier.</p>
    {% endif %}

{#    {% if is_granted('ROLE_USER') %}#}
{#        <div>#}
{#            {% for comm in commentary %}#}
{#                <p>{{ comm.user.name }}</p>#}
{#                <p>{{ comm.content }}</p>#}
{#            {% endfor %}#}
{#        </div>#}
{#    {% else %}#}
{#        <p style="text-align: center;">Pour accéder aux commentaires, veuillez-vous identifier.</p>#}
{#    {% endif %}#}

    {% if is_granted('ROLE_ADMIN') %}
        <div>
            <a href="{{ path('app_recipe_index') }}">back to list</a>
            <a href="{{ path('app_recipe_edit', {'id': recipe.id}) }}">edit</a>
            {{ include('recipe/_delete_form.html.twig') }}
        </div>
    {% endif %}

{#    {{ form_start(form, {'action': path('app_commentary_new', {id: recipe.id}), 'method': 'POST'}) }}#}
{#    {{ form_widget(form) }}#}
{#    <button class="btn">{{ button_label|default('Save') }}</button>#}
{#    {{ form_end(form) }}#}

{% endblock %}
